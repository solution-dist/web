#!/usr/bin/env bun
import {client,Component,createElement,css,state,html,SmartFormComponent,router}from'@je-es/client';import {table,primaryKey,notNull,text,defaultValue,integer,server}from'@je-es/server';import Ge from'path';var je=Object.create;var I=Object.defineProperty;var te=(t,o)=>(o=Symbol[t])?o:Symbol.for("Symbol."+t),A=t=>{throw TypeError(t)};var Fe=(t,o,e)=>o in t?I(t,o,{enumerable:true,configurable:true,writable:true,value:e}):t[o]=e;var w=(t,o)=>()=>(t&&(o=t(t=0)),o);var oe=(t,o)=>{for(var e in o)I(t,e,{get:o[e],enumerable:true});};var k=t=>[,,,je(t?.[te("metadata")]??null)],ae=["class","method","getter","setter","accessor","field","value","get","set"],K=t=>t!==void 0&&typeof t!="function"?A("Function expected"):t,De=(t,o,e,a,r)=>({kind:ae[t],name:o,metadata:a,addInitializer:s=>e._?A("Already initialized"):r.push(K(s||null))}),C=(t,o)=>Fe(o,te("metadata"),t[3]),p=(t,o,e,a)=>{for(var r=0,s=t[o>>1],c=s&&s.length;r<c;r++)o&1?s[r].call(e):a=s[r].call(e,a);return a},v=(t,o,e,a,r,s)=>{var d,W,E,V,i=o&7,$=false,g=false,q=t.length+1,X=(t[q-1]=[]),Ie=t[q]||(t[q]=[]);((r=r.prototype),i<5);for(var M=a.length-1;M>=0;M--)E=De(i,e,W={},t[3],Ie),(E.static=$,E.private=g,V=E.access={has:u=>e in u},(V.get=u=>u[e]),(V.set=(u,G)=>u[e]=G)),d=(0, a[M])(void 0,E),W._=1,K(d)&&(X.unshift(d));return r};function Ye(){return localStorage.getItem("app-language")||"en"}function n(t,o){let e=Ye(),a=U[t]?.[e]||U[t]?.en||t;return o&&Object.keys(o).forEach(r=>{let s=U[o[r]]?n(o[r]):o[r];a=a.replace(`{${r}}`,s);}),a}var U,P=w(()=>{U={loading:{en:"Loading...",ar:"\u062C\u0627\u0631\u064A \u0627\u0644\u062A\u062D\u0645\u064A\u0644...",es:"Cargando...",fr:"Chargement..."},"global.apply_changes_reloading":{en:"Applying changes...",ar:"\u062C\u0627\u0631\u064A \u062A\u0637\u0628\u064A\u0642 \u0627\u0644\u062A\u063A\u064A\u064A\u0631\u0627\u062A...",es:"Aplicando cambios...",fr:"Application des modifications..."},"nav.logo.text":{en:"\u{1F4DD} Todo App",ar:"\u{1F4DD} \u062A\u0637\u0628\u064A\u0642 \u0627\u0644\u0645\u0647\u0627\u0645",es:"\u{1F4DD} App de Tareas",fr:"\u{1F4DD} App de T\xE2ches"},"nav.home":{en:"Home",ar:"\u0627\u0644\u0631\u0626\u064A\u0633\u064A\u0629",es:"Inicio",fr:"Accueil"},"nav.todos":{en:"Todos",ar:"\u0627\u0644\u0645\u0647\u0627\u0645",es:"Tareas",fr:"T\xE2ches"},"theme.dark":{en:"Dark",ar:"\u062F\u0627\u0643\u0646",es:"Oscuro",fr:"Sombre"},"theme.light":{en:"Light",ar:"\u0641\u0627\u062A\u062D",es:"Claro",fr:"Clair"},"theme.rose":{en:"Rose",ar:"\u0648\u0631\u062F\u064A",es:"Rosa",fr:"Rose"},"theme.hacker":{en:"Hacker",ar:"\u0647\u0627\u0643\u0631",es:"Hacker",fr:"Hacker"},"todo.home.welc":{en:"Welcome to Todo App",ar:"\u0623\u0647\u0644\u064B\u0627 \u0628\u0650\u0640\u0643\u064E \u0641\u064A \u062A\u0637\u0628\u064A\u0642 \u0627\u0644\u0645\u0647\u0627\u0645",es:"Bienvenido a la App de Tareas",fr:"Bienvenue dans l'App de T\xE2ches"},"todo.home.desc":{en:"Organize your tasks efficiently with our modern, responsive todo application.",ar:"\u0646\u0638\u0645 \u0645\u0647\u0627\u0645\u0643 \u0648\u0639\u0632\u0632 \u0625\u0646\u062A\u0627\u062C\u064A\u062A\u0643 \u0628\u062A\u0637\u0628\u064A\u0642\u0646\u0627 \u0627\u0644\u062D\u062F\u064A\u062B \u0648\u0627\u0644\u0645\u062A\u062C\u0627\u0648\u0628",es:"Organiza tus tareas eficientemente con nuestra aplicaci\xF3n moderna y responsive.",fr:"Organisez vos t\xE2ches efficacement avec notre application moderne et responsive."},"todo.home.mainbutton":{en:"Get Started",ar:"\u0627\u0628\u062F\u0623 \u0627\u0644\u0622\u0646",es:"Comenzar",fr:"Commencer"},"todo.placeholder":{en:"What needs to be done?",ar:"\u0645\u0627 \u0627\u0644\u0630\u064A \u064A\u062C\u0628 \u0627\u0644\u0642\u064A\u0627\u0645 \u0628\u0647\u061F",es:"\xBFQu\xE9 hay que hacer?",fr:"Que faut-il faire?"},"todo.add":{en:"Add Task",ar:"\u0625\u0636\u0627\u0641\u0629 \u0645\u0647\u0645\u0629",es:"Agregar Tarea",fr:"Ajouter T\xE2che"},"todo.adding":{en:"\u23F3 Adding...",ar:"\u23F3 \u062C\u0627\u0631\u064A \u0627\u0644\u0625\u0636\u0627\u0641\u0629...",es:"\u23F3 Agregando...",fr:"\u23F3 Ajout..."},"todo.delete":{en:"Delete task",ar:"\u062D\u0630\u0641 \u0627\u0644\u0645\u0647\u0645\u0629",es:"Eliminar tarea",fr:"Supprimer la t\xE2che"},"todo.msg.required":{en:"Task title is required",ar:"\u0627\u0633\u0645 \u0627\u0644\u0645\u0647\u0645\u0629 \u0645\u0637\u0644\u0648\u0628",es:"El t\xEDtulo de la tarea es obligatorio",fr:"Le titre de la t\xE2che est requis"},"todo.filter.all":{en:"All ({count})",ar:"\u0627\u0644\u0643\u0644 ({count})",es:"Todos ({count})",fr:"Tous ({count})"},"todo.filter.active":{en:"Active ({count})",ar:"\u0646\u0634\u0637\u0629 ({count})",es:"Activas ({count})",fr:"Actives ({count})"},"todo.filter.completed":{en:"Completed ({count})",ar:"\u0645\u0643\u062A\u0645\u0644\u0629 ({count})",es:"Completadas ({count})",fr:"Termin\xE9es ({count})"},"todo.empty.none":{en:"No todos yet",ar:"\u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u0647\u0627\u0645 \u0628\u0639\u062F",es:"Sin tareas a\xFAn",fr:"Aucune t\xE2che pour le moment"},"todo.empty.none_filtered":{en:"No {filter} todos",ar:"\u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u0647\u0627\u0645 {filter}",es:"Sin tareas {filter}",fr:"Aucune t\xE2che {filter}"},"todo.empty.cta":{en:"Add your first task above to get started!",ar:"\u0623\u0636\u0641 \u0645\u0647\u0645\u062A\u0643 \u0627\u0644\u0623\u0648\u0644\u0649 \u0623\u0639\u0644\u0627\u0647 \u0644\u0644\u0628\u062F\u0621!",es:"\xA1Agrega tu primera tarea arriba para comenzar!",fr:"Ajoutez votre premi\xE8re t\xE2che ci-dessus pour commencer!"},"todo.empty.switch":{en:'Switch to "All" to see all todos',ar:'\u0627\u0646\u062A\u0642\u0644 \u0625\u0644\u0649 "\u0627\u0644\u0643\u0644" \u0644\u0631\u0624\u064A\u0629 \u062C\u0645\u064A\u0639 \u0627\u0644\u0645\u0647\u0627\u0645',es:'Cambia a "Todos" para ver todas las tareas',fr:'Passez \xE0 "Tous" pour voir toutes les t\xE2ches'},"filter.all":{en:"all",ar:"\u0627\u0644\u0643\u0644",es:"todas",fr:"toutes"},"filter.active":{en:"active",ar:"\u0646\u0634\u0637\u0629",es:"activas",fr:"actives"},"filter.completed":{en:"completed",ar:"\u0645\u0643\u062A\u0645\u0644\u0629",es:"completadas",fr:"termin\xE9es"},"toast.success.created":{en:"Task created successfully",ar:"\u062A\u0645 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0645\u0647\u0645\u0629 \u0628\u0646\u062C\u0627\u062D",es:"Tarea creada con \xE9xito",fr:"T\xE2che cr\xE9\xE9e avec succ\xE8s"},"toast.success.deleted":{en:"Task deleted successfully",ar:"\u062A\u0645 \u062D\u0630\u0641 \u0627\u0644\u0645\u0647\u0645\u0629 \u0628\u0646\u062C\u0627\u062D",es:"Tarea eliminada con \xE9xito",fr:"T\xE2che supprim\xE9e avec succ\xE8s"},"toast.info.completed":{en:"Task marked as completed",ar:"\u062A\u0645 \u0648\u0636\u0639 \u0639\u0644\u0627\u0645\u0629 \u0639\u0644\u0649 \u0627\u0644\u0645\u0647\u0645\u0629 \u0643\u0645\u0643\u062A\u0645\u0644\u0629",es:"Tarea marcada como completada",fr:"T\xE2che marqu\xE9e comme termin\xE9e"},"toast.info.uncompleted":{en:"Task marked as active",ar:"\u062A\u0645 \u0648\u0636\u0639 \u0639\u0644\u0627\u0645\u0629 \u0639\u0644\u0649 \u0627\u0644\u0645\u0647\u0645\u0629 \u0643\u0646\u0634\u0637\u0629",es:"Tarea marcada como activa",fr:"T\xE2che marqu\xE9e comme active"},"toast.error.create":{en:"Failed to create task",ar:"\u0641\u0634\u0644 \u0641\u064A \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0645\u0647\u0645\u0629",es:"Error al crear la tarea",fr:"\xC9chec de la cr\xE9ation de la t\xE2che"},"toast.error.delete":{en:"Failed to delete task",ar:"\u0641\u0634\u0644 \u0641\u064A \u062D\u0630\u0641 \u0627\u0644\u0645\u0647\u0645\u0629",es:"Error al eliminar la tarea",fr:"\xC9chec de la suppression de la t\xE2che"},"toast.error.toggle":{en:"Failed to update task",ar:"\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u0645\u0647\u0645\u0629",es:"Error al actualizar la tarea",fr:"\xC9chec de la mise \xE0 jour de la t\xE2che"},"toast.error.load":{en:"Failed to load tasks",ar:"\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0645\u0647\u0627\u0645",es:"Error al cargar las tareas",fr:"\xC9chec du chargement des t\xE2ches"},"popup.ok":{en:"OK",ar:"\u0645\u0648\u0627\u0641\u0642",es:"OK",fr:"OK"},"popup.cancel":{en:"Cancel",ar:"\u0625\u0644\u063A\u0627\u0621",es:"Cancelar",fr:"Annuler"},"popup.confirm":{en:"Confirm",ar:"\u062A\u0623\u0643\u064A\u062F",es:"Confirmar",fr:"Confirmer"},"popup.delete.title":{en:"Delete Task",ar:"\u062D\u0630\u0641 \u0627\u0644\u0645\u0647\u0645\u0629",es:"Eliminar Tarea",fr:"Supprimer la T\xE2che"},"popup.delete.message":{en:"Are you sure you want to delete this task? This action cannot be undone.",ar:"\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0645\u0646 \u062D\u0630\u0641 \u0647\u0630\u0647 \u0627\u0644\u0645\u0647\u0645\u0629\u061F \u0644\u0627 \u064A\u0645\u0643\u0646 \u0627\u0644\u062A\u0631\u0627\u062C\u0639 \u0639\u0646 \u0647\u0630\u0627 \u0627\u0644\u0625\u062C\u0631\u0627\u0621.",es:"\xBFEst\xE1s seguro de que deseas eliminar esta tarea? Esta acci\xF3n no se puede deshacer.",fr:"\xCAtes-vous s\xFBr de vouloir supprimer cette t\xE2che? Cette action est irr\xE9versible."},"popup.delete.confirm":{en:"Delete",ar:"\u062D\u0630\u0641",es:"Eliminar",fr:"Supprimer"},"popup.prompt.placeholder":{en:"Enter value...",ar:"\u0623\u062F\u062E\u0644 \u0627\u0644\u0642\u064A\u0645\u0629...",es:"Ingresa el valor...",fr:"Entrez la valeur..."},"layout.footer.text":{en:"Built with \u2764\uFE0F by",ar:"\u0635\u064F\u0640\u0646\u0650\u0640\u0639\u064E \u0628\u0650\u0640\u0643\u064F\u0644\u0650 \u2764\uFE0F \u0628\u0650\u0648\u0627\u0633\u0650\u0637\u064E\u0640\u0629",es:"Hecho con \u2764\uFE0F por",fr:"Cr\xE9\xE9 avec \u2764\uFE0F par"},"layout.footer.link":{en:"Maysara",ar:"\u0645\u064E\u064A\u0652\u0633\u064E\u0640\u0631\u0629",es:"Maysara",fr:"Maysara"}};});function ue(t){router.push(t),window.dispatchEvent(new CustomEvent("navigation",{detail:{path:t}}));}var fe=w(()=>{});var he={};oe(he,{HomePage:()=>Q});var Q,ge=w(()=>{P();fe();Q=class extends Component{async onMount(){let o=this.element?.querySelector('[data-action="get-started"]');o&&o.addEventListener("click",e=>this.handleGetStarted(e));}handleGetStarted(o){o.preventDefault(),ue("/todos");}render(){return createElement("div",{className:"__page__"},createElement("div",{className:"__header__"},createElement("h1",{className:"__title__","data-translate":"todo.home.welc"},n("todo.home.welc")),createElement("p",{className:"__desc__","data-translate":"todo.home.desc"},n("todo.home.desc"))),createElement("button",{className:"btn btn--primary btn--large","data-translate":"todo.home.mainbutton","data-action":"get-started",onclick:o=>this.handleGetStarted(o)},n("todo.home.mainbutton"),createElement("i",{className:"fas fa-rocket",style:"margin-right: 8px;"})))}styles(){return css` `}};});function st(t){if(_)return _;let o=document.createElement("div");return document.body.appendChild(o),_=new L,_.mount(o),_}function N(){return _||(_=st()),_}var ye,ve,F,L,_,y,_e=w(()=>{P();L=class extends(ve=Component,ye=[state],ve){constructor(){super(...arguments);this.messages=p(F,8,this,[]),p(F,11,this);this.nextId=0;}show(e,a="info",r=2e3,s){let c=this.nextId++;this.messages=[...this.messages,{id:c,message:e,type:a,translateKey:s}],setTimeout(()=>{this.messages=this.messages.filter(d=>d.id!==c);},r);}success(e,a,r){this.show(e,"success",a,r);}error(e,a,r){this.show(e,"error",a,r);}info(e,a,r){this.show(e,"info",a,r);}warning(e,a,r){this.show(e,"warning",a,r);}render(){return this.messages.length===0?html``:createElement("div",{className:"__toast_container__"},...this.messages.map(e=>this.renderToast(e)))}renderToast(e){let a={success:"fas fa-check-circle",error:"fas fa-exclamation-circle",info:"fas fa-info-circle",warning:"fas fa-exclamation-triangle"},r=e.translateKey?n(e.translateKey):e.message;return createElement("div",{key:String(e.id),className:`__toast__ __toast__--${e.type}`,"data-translate":e.translateKey||void 0},createElement("i",{className:`${a[e.type]} __toast_icon__`}),createElement("span",{className:"__toast_message__"},r))}};F=k(ve),v(F,5,"messages",ye,L),C(F,L);_=null;y={show:(t,o="info",e,a)=>{N().show(t,o,e,a);},success:(t,o,e)=>{N().success(t,o,e);},error:(t,o,e)=>{N().error(t,o,e);},info:(t,o,e)=>{N().info(t,o,e);},warning:(t,o,e)=>{N().warning(t,o,e);}};});function lt(t){if(T)return T;let o=document.createElement("div");return document.body.appendChild(o),T=new O,T.mount(o),T}function S(){return T||(T=lt()),T}var Te,be,D,O,T,Ce,we=w(()=>{P();O=class extends(be=Component,Te=[state],be){constructor(){super(...arguments);this.popups=p(D,8,this,[]),p(D,11,this);this.nextId=0;this.handleEscapeKey=void 0;}async onMount(){this.setupKeyboardListener(),window.addEventListener("languagechange",()=>{this.update();});}onUnmount(){this.handleEscapeKey&&document.removeEventListener("keydown",this.handleEscapeKey);}render(){return this.popups.length===0?createElement("div",{className:"__popup_container__"}):createElement("div",{className:"__popup_container__"},...this.popups.map(e=>this.renderPopup(e)))}renderPopup(e){let a=`__popup__--${e.width||"medium"}`,r=e.variant?`__popup__--${e.variant}`:"";return createElement("div",{key:String(e.id),className:"__popup_overlay__",onClick:s=>{s.target.classList.contains("__popup_overlay__")&&e.closeOnOverlay!==false&&this.closePopup(e.id,false);}},createElement("div",{className:`__popup__ ${a} ${r}`,role:"dialog","aria-modal":"true","aria-labelledby":`popup-title-${e.id}`},e.showCloseButton!==false?createElement("button",{className:"__popup_close__",onClick:()=>this.closePopup(e.id,false),"aria-label":"Close"},createElement("i",{className:"fas fa-times"})):null,createElement("div",{className:"__popup_header__"},e.icon?createElement("div",{className:"__popup_icon__"},createElement("i",{className:e.icon})):null,createElement("h2",{id:`popup-title-${e.id}`,className:"__popup_title__","data-translate":e.titleTranslateKey},e.titleTranslateKey?n(e.titleTranslateKey):e.title)),createElement("div",{className:"__popup_body__"},e.message?createElement("p",{className:"__popup_message__","data-translate":e.messageTranslateKey},e.messageTranslateKey?n(e.messageTranslateKey):e.message):null,e.type==="prompt"?createElement("input",{type:"text",className:"__popup_input__",value:e.inputValue||"",placeholder:n("popup.prompt.placeholder"),"data-translate":"popup.prompt.placeholder",onInput:s=>{e.inputValue=s.target.value;}}):null,e.customContent||null),e.buttons&&e.buttons.length>0?createElement("div",{className:"__popup_footer__"},...e.buttons.map(s=>createElement("button",{className:`btn btn--${s.variant||"secondary"}`,"data-translate":s.translateKey,onClick:async()=>{await s.onClick();}},s.translateKey?n(s.translateKey):s.label))):null))}show(e){return new Promise(a=>{let r=this.nextId++,s={...e,id:r,resolve:a,type:e.type||"custom",closeOnOverlay:e.closeOnOverlay!==false,closeOnEscape:e.closeOnEscape!==false,showCloseButton:e.showCloseButton!==false};this.popups=[...this.popups,s],this.applyBodyLock();})}confirm(e){return new Promise(a=>{let r=this.nextId++,s={id:r,title:e.title,titleTranslateKey:e.titleTranslateKey,message:e.message,messageTranslateKey:e.messageTranslateKey,type:"confirm",variant:e.variant||"default",icon:e.icon,resolve:a,onConfirm:e.onConfirm,onCancel:e.onCancel,buttons:[{label:e.cancelLabel||"Cancel",translateKey:e.cancelTranslateKey||"popup.cancel",variant:"secondary",onClick:async()=>{e.onCancel&&await e.onCancel(),this.closePopup(r,false);}},{label:e.confirmLabel||"Confirm",translateKey:e.confirmTranslateKey||"popup.confirm",variant:e.variant==="danger"?"danger":"primary",onClick:async()=>{e.onConfirm&&await e.onConfirm(),this.closePopup(r,true);}}]};this.popups=[...this.popups,s],this.applyBodyLock();})}alert(e){return new Promise(a=>{let r=this.nextId++,s={id:r,title:e.title,titleTranslateKey:e.titleTranslateKey,message:e.message,messageTranslateKey:e.messageTranslateKey,type:"alert",variant:e.variant||"info",icon:e.icon,resolve:a,onConfirm:e.onConfirm,buttons:[{label:e.okLabel||"OK",translateKey:e.okTranslateKey||"popup.ok",variant:"primary",onClick:async()=>{e.onConfirm&&await e.onConfirm(),this.closePopup(r,true);}}]};this.popups=[...this.popups,s],this.applyBodyLock();})}prompt(e){return new Promise(a=>{let r=this.nextId++,s={id:r,title:e.title,titleTranslateKey:e.titleTranslateKey,message:e.message,messageTranslateKey:e.messageTranslateKey,type:"prompt",variant:"default",icon:e.icon,inputValue:e.defaultValue||"",resolve:a,onConfirm:e.onConfirm,onCancel:e.onCancel,buttons:[{label:e.cancelLabel||"Cancel",translateKey:e.cancelTranslateKey||"popup.cancel",variant:"secondary",onClick:async()=>{e.onCancel&&await e.onCancel(),this.closePopup(r,null);}},{label:e.confirmLabel||"OK",translateKey:e.confirmTranslateKey||"popup.ok",variant:"primary",onClick:async()=>{let c=s.inputValue||"";e.onConfirm&&await e.onConfirm(c),this.closePopup(r,c);}}]};this.popups=[...this.popups,s],this.applyBodyLock();})}closePopup(e,a){let r=this.popups.find(s=>s.id===e);r?.resolve&&r.resolve(a),this.popups=this.popups.filter(s=>s.id!==e),this.popups.length===0&&this.removeBodyLock();}closeAll(){this.popups.forEach(e=>{e.resolve&&e.resolve(false);}),this.popups=[],this.removeBodyLock();}applyBodyLock(){document.body.style.overflow="hidden";}removeBodyLock(){document.body.style.overflow="";}setupKeyboardListener(){this.handleEscapeKey=e=>{if(e.key==="Escape"&&this.popups.length>0){let a=this.popups[this.popups.length-1];a.closeOnEscape!==false&&this.closePopup(a.id,false);}},document.addEventListener("keydown",this.handleEscapeKey);}};D=k(be),v(D,5,"popups",Te,O),C(D,O);T=null;Ce={show:t=>S().show(t),confirm:t=>S().confirm(t),alert:t=>S().alert(t),prompt:t=>S().prompt(t),closeAll:()=>S().closeAll()};});var Ne={};oe(Ne,{TodoPage:()=>b});var xe,Ee,Ke,Ae,Pe,f,b,Le=w(()=>{P();_e();we();b=class extends(Pe=Component,Ae=[state],Ke=[state],Ee=[state],xe=[state],Pe){constructor(e){super(e);this.todos=p(f,8,this,[]),p(f,11,this);this.loading=p(f,12,this,false),p(f,15,this);this.filter=p(f,16,this,"all"),p(f,19,this);this.formInstance=p(f,20,this,null),p(f,23,this);this.handleToggleTodo=async e=>{let a=this.todos.find(s=>s.id===e);if(!a)return;let r=a.completed;try{await fetch(`/api/todos/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({completed:r?0:1})}),await this.loadTodos(),r?y.info(n("toast.info.uncompleted"),2e3,"toast.info.uncompleted"):y.info(n("toast.info.completed"),2e3,"toast.info.completed");}catch(s){console.error("\u274C Failed to toggle todo:",s),y.error(n("toast.error.toggle"),3e3,"toast.error.toggle");}};this.handleDeleteTodo=async e=>{let a=this.todos.find(s=>s.id===e);if(!a)return;await Ce.confirm({title:"Delete Task",titleTranslateKey:"popup.delete.title",message:`Are you sure you want to delete "${a.title}"? This action cannot be undone.`,messageTranslateKey:"popup.delete.message",confirmLabel:"Delete",confirmTranslateKey:"popup.delete.confirm",cancelLabel:"Cancel",cancelTranslateKey:"popup.cancel",variant:"danger",icon:"fas fa-trash-alt",onConfirm:async()=>{try{await fetch(`/api/todos/${e}`,{method:"DELETE"}),this.todos=this.todos.filter(s=>s.id!==e),y.success(n("toast.success.deleted"),2e3,"toast.success.deleted");}catch(s){console.error("\u274C Failed to delete todo:",s),y.error(n("toast.error.delete"),3e3,"toast.error.delete"),await this.loadTodos();}},onCancel:()=>{console.log("Delete cancelled");}})&&console.log("User confirmed deletion");};this.handleSetFilter=e=>{this.filter=e,localStorage.setItem("todo-filter",e);};this.formInstance=new SmartFormComponent(this.getFormConfig());}get filteredTodos(){return this.memo("filteredTodos",()=>{let e=this.todos||[];switch(this.filter){case "active":return e.filter(a=>!a.completed);case "completed":return e.filter(a=>a.completed);default:return e}},[this.todos,this.filter])}get stats(){return this.memo("stats",()=>{let e=this.todos||[];return {total:e.length,active:e.filter(a=>!a.completed).length,completed:e.filter(a=>a.completed).length}},[this.todos])}async onMount(){await this.loadTodos();}async loadTodos(){this.loading=true;try{let a=await(await fetch("/api/todos")).json();this.todos=Array.isArray(a)?a:[];}catch(e){console.error("\u274C Failed to load todos:",e),this.todos=[],y.error(n("toast.error.load"),3e3,"toast.error.load");}finally{this.loading=false;}}getFormConfig(){return {fields:[{name:"title",type:"text",placeholder:n("todo.placeholder"),className:"",validation:{required:true,minLength:1,message:n("todo.msg.required")}}],endpoint:"/api/todos",method:"POST",autoValidate:true,submitButton:{label:"\u2795",loadingLabel:"Adding...",className:"btn btn--primary btn--icon-only"},className:"__form__ __form__--linear",onSuccess:async()=>{this.formInstance=new SmartFormComponent(this.getFormConfig()),await this.loadTodos(),y.success(n("toast.success.created"),2e3,"toast.success.created");},onValidationError:e=>{let a=Object.values(e)[0];a&&y.warning(a,3e3);},onError:e=>{console.error("\u274C Failed to create todo:",e),y.error(n("toast.error.create"),3e3,"toast.error.create");}}}render(){let e=this.stats,a=this.filteredTodos;return createElement("div",{className:"__page__"},this.loading?createElement("div",{className:"alert alert-info"},createElement("i",{className:"fas fa-spinner fa-spin",style:"margin-right: 8px;"}),"Loading your todos..."):null,createElement("div",{className:"__card__"},this.formInstance?this.formInstance.render():createElement("div",{},"Loading form...")),createElement("div",{className:"__card__ __card__--secondary",style:"scale: 0.9; display: flex ; justify-content: space-evenly; align-items: center; gap: 10px !important;"},this.createFilterButton("all","All",e.total,"fa-list"),this.createFilterButton("active","Active",e.active,"fa-bolt"),this.createFilterButton("completed","Completed",e.completed,"fa-check-circle")),a.length===0&&!this.loading?createElement("div",{className:"__card__ __card__--compact"},createElement("div",{className:"card-header"},createElement("h2",{className:"card-title"}),createElement("div",{className:"card-body"},createElement("div",{className:"empty-state__icon"},createElement("i",{className:"fas fa-clipboard-list",style:"font-size: 3rem;"})),createElement("p",{},this.filter==="all"?n("todo.empty.none"):n("todo.empty.none_filtered",{filter:"filter."+this.filter}))),createElement("p",{className:"empty-state__description","data-translate":"todo.empty.cta"},this.filter==="all"?n("todo.empty.cta"):n("todo.empty.switch")))):null,a.length>0?createElement("div",{className:"__card_container__ __card_container__--column"},...a.map(r=>this.renderTodoItem(r))):null)}createFilterButton(e,a,r,s){let c=this.filter===e,d=()=>this.handleSetFilter(e);return createElement("button",{className:c?"todo_page_filter_button btn btn--primary":" todo_page_filter_button btn btn--secondary","data-translate":`todo.filter.${e}`,onclick:d},createElement("i",{className:`fas ${s}`}),`${n(`todo.filter.${e}`,{count:String(r)})}`)}renderTodoItem(e){let a=()=>this.handleToggleTodo(e.id),r=()=>this.handleDeleteTodo(e.id);return createElement("div",{className:"__card__ __card__--tertiary __card__--hoverable",key:String(e.id),style:"display: flex; align-items: center; gap: var(--spacing-md);"},createElement("label",{className:"form-checkbox",style:"flex: 1;"},createElement("input",{type:"checkbox",checked:!!e.completed,onchange:a}),createElement("span",{style:e.completed?"text-decoration: line-through; opacity: 0.6;":""},e.title)),createElement("button",{className:"btn btn--danger btn--small",onclick:r,title:"Delete task"},createElement("i",{className:"fas fa-times"})))}};f=k(Pe),v(f,5,"todos",Ae,b),v(f,5,"loading",Ke,b),v(f,5,"filter",Ee,b),v(f,5,"formInstance",xe,b),C(f,b);});var ne=table("todos",[primaryKey(integer("id"),true),notNull(text("title")),text("text"),defaultValue(integer("completed"),0),defaultValue(text("created_at"),new Date().toISOString())]);var ie=process.env.PORT||3e3,le=process.env.HOSTNAME||"localhost",ze=(process.env.CORS_ORIGINS||`http://${le}:${ie}`).split(","),He=process.env.LOG_LEVEL||"info",Ue=process.env.STATIC_PATH||"/static",Qe=Ge.resolve(process.env.STATIC_DIR||"./src/frontend/static"),We=process.env.DATABASE_URL||"{{name}}.db",ce={port:ie,hostname:le,requestTimeout:3e4,maxRequestSize:10485760,routes:[],static:{path:Ue,directory:Qe},security:{rateLimit:{max:100,windowMs:6e4,message:"Too many requests. Please try again later.",keyGenerator:t=>t.request?.headers?.get?.("x-api-key")||t.ip||"unknown"},cors:{origin:ze,credentials:true,methods:["GET","POST","PUT","DELETE","PATCH"],allowedHeaders:["Content-Type","Authorization","X-Request-ID"]},csrf:true},logging:{level:He,pretty:true},database:{connection:We,schema:{todos:ne}},onShutdown:async()=>{}};var de=[{method:"GET",path:"/api/todos",handler:async t=>{try{let o=t.db.all("todos");return t.json(o,200)}catch(o){return console.error("Error fetching todos:",o),t.json({error:"Failed to fetch todos"},500)}}},{method:"GET",path:"/api/todos/:id",handler:async t=>{try{let o=parseInt(t.params.id),e=t.db.findById("todos",o);return e?t.json(e,200):t.json({error:"Todo not found"},404)}catch(o){return console.error("Error fetching todo:",o),t.json({error:"Failed to fetch todo"},500)}}},{method:"POST",path:"/api/todos",handler:async t=>{try{let o=t.body,{title:e,text:a}=o;if(!e||e.trim()==="")return t.json({error:"Title is required"},400);let r=t.db.insert("todos",{title:e.trim(),text:a||null,completed:0,created_at:new Date().toISOString()});return t.json(r,201)}catch(o){return console.error("Error creating todo:",o),t.json({error:"Failed to create todo"},500)}}},{method:"PUT",path:"/api/todos/:id",handler:async t=>{try{let o=parseInt(t.params.id),e=t.body,{title:a,text:r,completed:s}=e,c={};if(a!==void 0&&(c.title=a),r!==void 0&&(c.text=r),s!==void 0&&(c.completed=s),Object.keys(c).length===0)return t.json({error:"No fields to update"},400);let d=t.db.update("todos",o,c);return d?t.json(d,200):t.json({error:"Todo not found"},404)}catch(o){return console.error("Error updating todo:",o),t.json({error:"Failed to update todo"},500)}}},{method:"DELETE",path:"/api/todos/:id",handler:async t=>{try{let o=parseInt(t.params.id);return t.db.delete("todos",o)?t.json({success:!0,id:o},200):t.json({error:"Todo not found"},404)}catch(o){return console.error("Error deleting todo:",o),t.json({error:"Failed to delete todo"},500)}}}];var me=[...de,{method:"GET",path:"/",handler:t=>{let o=pe();return t.html(o,200)}},{method:"GET",path:"/todos",handler:t=>{let o=pe();return t.html(o,200)}}],pe=(t="http://localhost:3000")=>`
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8" />
                <meta name="viewport" content="width=device-width, initial-scale=1.0" />
                <title>{{title}}</title>

                <link rel="stylesheet" href="static/css/client.css">
                <link rel="stylesheet" href="static/css/fonts/index.css">
            </head>
            <body id="app">
                <script type="module" src="static/js/client.js"></script>
            </body>
            </html>
        `;var j=server({...ce,routes:me});var Se=[{path:"/",component:()=>Promise.resolve().then(()=>(ge(),he)),meta:{title:"Home"}},{path:"/todos",component:()=>Promise.resolve().then(()=>(Le(),Ne)),meta:{title:"Todos"}}];var Oe=client({build:{entry:"./src/frontend/app/core/browser.ts",output:"./src/frontend/static/js/client.js",minify:true,sourcemap:true,styles:{output:"./src/frontend/static/css/client.css",input:"./src/frontend/app/gui/style/"}},app:{root:"#app",routes:Se,mode:"spa"},router:{mode:"history",base:"/",scrollBehavior:"smooth"},api:{baseURL:process.env.NODE_ENV==="production"?"https://api.myapp.com":"http://localhost:3000",timeout:3e4,headers:{"Content-Type":"application/json"},interceptors:{request:t=>{let o=localStorage.getItem("token");return o&&(t.headers.Authorization=`Bearer ${o}`),t},error:t=>{throw t.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),t}}},forms:{autoValidate:true,csrfProtection:true},devTools:{enabled:process.env.NODE_ENV==="development",showRouterInfo:true}});async function mt(){process.on("SIGTERM",async()=>{await j.stop(),process.exit(0);}),process.on("SIGINT",async()=>{await j.stop(),process.exit(0);}),await Oe.build(),j.start().then(()=>{}).catch(t=>{console.error("\u274C Failed to start server:",t),process.exit(1);});}mt();//# sourceMappingURL=main.js.map
//# sourceMappingURL=main.js.map